@using Final_Backend_Project.ViewModelsUI
@model CategoryProductVM

<section id="home-products">
    <div class="container-xl">
        <div class="row">
            <div class="products-title col-12">
                <h2>Our Best Sellers</h2>
                <div class="featured__controls">
                    <div class="btn-group">
                        <button class="active filter-btn" data-filter="0">All</button>
                        @foreach (var category in Model.Categories)
                        {
                            <button class="filter-btn" data-filter="@category.Id">@category.Name</button>
                        }
                    </div>
                </div>

            </div>
            <div id="product-container">
                @await Html.PartialAsync("_ProductsPartial", Model.Products)
            </div>
        </div>
    </div>
</section>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const buttons = document.querySelectorAll(".filter-btn");
        buttons.forEach(btn => {
            btn.addEventListener("click", () => {
                const categoryId = btn.getAttribute("data-filter");

                buttons.forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                fetch(`/Home/FilterProducts?categoryId=${categoryId}`)
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById("product-container").innerHTML = html;
                    })
                    .catch(err => console.error(err));
            });
        });
    });

</script>

<style>
    .btn-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .filter-btn {
        padding: 10px 20px;
        background-color: #eee;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        font-weight: bold;
        transition: 0.2s;
    }

        .filter-btn.active {
            background-color: purple;
            color: white;
        }

</style>